class Solution:
    def validateStackSequences(self, pushed: List[int], popped: List[int]) -> bool:
        counti = countj = 0
        length = len(pushed)
        ans = list()
        while counti < length and countj < length:
            if pushed[counti] == popped[countj]:
                counti += 1
                countj += 1
                continue
            if len(ans) > 0:
                if popped[countj] == ans[-1]:
                    ans.pop()
                    countj += 1
                    continue
            if (pushed[counti] != popped[countj]):
                ans.append(pushed[counti])
                counti += 1
                continue
        if len(ans) != 0:
            if countj < length:
                limit = length - countj
                i = 0
                while i < limit:
                    if popped[countj] == ans[-1]:
                        ans.pop()
                        countj += 1
                    i += 1
                if len(ans) != 0:
                    return False
        return True
